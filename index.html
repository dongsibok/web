<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš— ì°¨ëŸ‰ìš´í–‰ì¼ì§€</title>
    <style>
        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: sans-serif; background: #f4f7f6; color: #333; line-height: 1.6; }
        .container { max-width: 700px; margin: 20px auto; padding: 0 15px; }

        .header { text-align: center; margin-bottom: 20px; }
        .header h1 { font-size: 2rem; margin-bottom: 5px; color: #007bff; }

        .form-card { background: white; border-radius: 8px; padding: 20px; margin-bottom: 15px; border: 1px solid #ddd; }
        .section-title { font-size: 1.2rem; color: #333; margin-bottom: 15px; padding-bottom: 5px; border-bottom: 1px solid #eee; }

        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .form-row-single { grid-template-columns: 1fr; } 
        .form-group { display: flex; flex-direction: column; }
        
        label { font-weight: 500; margin-bottom: 5px; font-size: 0.9rem; }
        
        select, input[type="text"], input[type="number"], input[type="time"], input[type="date"], textarea {
            padding: 10px 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
        }
        select:focus, input:focus, textarea:focus { outline: none; border-color: #007bff; }
        textarea { resize: vertical; min-height: 80px; }

        .km-display { background: #e9ecef !important; font-weight: bold !important; text-align: center !important; }
        
        .time-input-group { display: flex; gap: 5px; }
        
        .btn { padding: 10px 15px; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background-color 0.2s; }
        .btn-success { background: #28a745; color: white; width: 100%; padding: 12px; margin-top: 10px; }
        .btn-success:hover { background: #218838; }
        .btn-success:disabled { background: #6c757d; cursor: not-allowed; }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #5a6268; }

        .alert { padding: 12px; border-radius: 4px; margin: 10px 0; font-weight: 500; display: none; }
        .alert.show { display: block; }
        .alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .alert-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .alert-warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        
        .saved-data { 
            background: #f8f9fa; 
            border-left: 4px solid #28a745; 
            padding: 12px 15px; 
            margin-top: 10px; 
            border-radius: 4px; 
            font-size: 0.9rem; 
        }
        .saved-data-title { 
            font-weight: bold; 
            color: #155724; 
            margin-bottom: 8px; 
            font-size: 1rem; 
        }
        .saved-data-item { 
            display: grid; 
            grid-template-columns: 120px 1fr; 
            gap: 10px; 
            padding: 4px 0; 
            border-bottom: 1px dotted #dee2e6; 
        }
        .saved-data-item:last-child { border-bottom: none; }
        .saved-data-label { font-weight: 500; color: #666; }
        .saved-data-value { color: #333; word-break: break-word; } /* ê¸´ í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ì²˜ë¦¬ */
        
        #loadingOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); color: white;
            display: none; align-items: center; justify-content: center; z-index: 9999; font-size: 1.2rem;
            flex-direction: column; gap: 15px;
        }
        .loading-spinner { 
            width: 40px; height: 40px; 
            border: 4px solid rgba(255,255,255,0.3); 
            border-top: 4px solid white; 
            border-radius: 50%; 
            animation: spin 1s linear infinite; 
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .helper-text { font-size: 0.85rem; color: #666; margin-top: 3px; }
        
        .debug-info { 
            background: #f8f9fa; 
            border: 1px solid #dee2e6; 
            border-radius: 4px; 
            padding: 10px; 
            margin: 10px 0; 
            font-size: 0.85rem; 
            font-family: monospace;
            display: none;
        }
        .debug-info.show { display: block; }

        @media (max-width: 600px) {
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš— ì°¨ëŸ‰ìš´í–‰ì¼ì§€</h1>
            <p>ë™ëŒ€ë¬¸ì‹œê°íŠ¹í™”ì¥ì• ì¸ë³µì§€ê´€</p>
        </div>

        <div class="alert alert-success" id="successAlert"></div>
        <div id="savedDataDisplay"></div>
        <div class="alert alert-error" id="errorAlert"></div>
        <div class="alert alert-warning" id="warningAlert"></div>
        <div class="debug-info" id="debugInfo"></div>

        <form id="vehicleLogForm">
            <div class="form-card">
                <h2 class="section-title">ğŸ‘¤ ê¸°ë³¸ ì •ë³´</h2>
                
                <div class="form-group">
                    <label for="vehicle">ì°¨ëŸ‰ë²ˆí˜¸</label>
                    <select id="vehicle" name="vehicle" required>
                        <option value="">ì°¨ëŸ‰ì„ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="ì‹ ìŠ¤íŒŒí¬">ì‹ ìŠ¤íŒŒí¬(257ê³ 1416)</option>
                        <option value="êµ¬ìŠ¤íŒŒí¬">êµ¬ìŠ¤íŒŒí¬(40ë³´2224)</option>
                        <option value="ë ˆì´">ë ˆì´(28ì €7467)</option>
                        <option value="KìŠ¤íƒ€ë ‰ìŠ¤">KìŠ¤íƒ€ë ‰ìŠ¤(72ë§ˆ7689)</option>
                        <option value="GìŠ¤íƒ€ë ‰ìŠ¤">GìŠ¤íƒ€ë ‰ìŠ¤(71ë”7566)</option>
                        <option value="ì´ì¹´ìš´í‹°">ì´ì¹´ìš´í‹°(72ë²„5995)</option>
                    </select>
                </div>

                <div class="form-row form-row-single">
                    <div class="form-group">
                        <label for="driver">ìš´ì „ì (ì„ íƒ ë˜ëŠ” ì§ì ‘ ì…ë ¥)</label>
                        <input type="text" id="driver" name="driver" list="driverList" placeholder="ìš´ì „ì ì„ íƒ ë˜ëŠ” ì…ë ¥" required>
                        <datalist id="driverList">
                            <option value="ê°•ì§€ì—°">
                            <option value="ê¹€ë¯¸ê²½">
                            <option value="ì „ìƒì„">
                            <option value="ê¹€ì˜ˆê·¼">
                            <option value="ê¹€ì§„ë²”">
                            <option value="ë¬¸ë³´ì€">
                            <option value="ë¬¸ìŠ¹ì¤€">
                            <option value="ë°•ê²½í˜œ">
                            <option value="ë°•ì• ë€">
                            <option value="ë°•ì˜ˆì¸">
                            <option value="ë°•ì¼ê·œ">
                            <option value="ì†¡ì€êµ">
                            <option value="ì—¬ì¤€í˜•">
                            <option value="ì˜¤ì² ìˆ˜">
                            <option value="ì˜¥ìˆ˜ì•ˆ">
                            <option value="ì´ê´‘í¬">
                            <option value="ì´ê²½í›ˆ">
                            <option value="ì„ë¯¸ì§„">
                            <option value="ì„ë³‘ìˆ˜">
                            <option value="ì¥ì§€ì˜ˆ">
                            <option value="ì§„íƒœì§„">
                            <option value="ìµœìš©ê·¼">
                            <option value="í—ˆì±„ì˜">
                            <option value="í—ˆì² ë¯¼">
                        </datalist>
                    </div>
                </div>
            </div>

            <div class="form-card">
                <h2 class="section-title">ğŸ¯ ìš´í–‰ ì •ë³´</h2>
                <div class="form-group">
                    <label for="customDestination">í–‰ì„ ì§€</label>
                    <input type="text" id="customDestination" name="destination" placeholder="í–‰ì„ ì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                
                <div class="form-group">
                    <label for="purpose">ìš´í–‰ëª©ì  (ì„ íƒ ë˜ëŠ” ì§ì ‘ ì…ë ¥)</label>
                    <input type="text" id="purpose" name="purpose" list="purposeList" placeholder="ìš´í–‰ ëª©ì  ì„ íƒ ë˜ëŠ” ì…ë ¥" required>
                    <datalist id="purposeList">
                        <option value="ì´ë™ì§€ì›">
                        <option value="í›„ì›">
                        <option value="í”„ë¡œê·¸ë¨">
                        <option value="ë¬¼í’ˆêµ¬ì…">
                        <option value="ê¸°ê´€ë°©ë¬¸">
                        <option value="ê¸°íƒ€">
                    </datalist>
                </div>
            </div>

            <div class="form-card">
                <h2 class="section-title">â° ì‹œê°„ ë° ê±°ë¦¬</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="tripDate">ìš´í–‰ ë‚ ì§œ</label>
                        <input type="date" id="tripDate" name="tripDate" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="departureTime">ì¶œë°œì‹œê°</label>
                        <div class="time-input-group">
                            <input type="time" id="departureTime" name="departureTime" required style="flex-grow: 1;">
                            <button type="button" class="btn btn-secondary" id="setDepartureTimeBtn" title="í˜„ì¬ ì‹œê°ìœ¼ë¡œ ì„¤ì •">â°</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="arrivalTime">ë„ì°©ì‹œê°</label>
                        <div class="time-input-group">
                            <input type="time" id="arrivalTime" name="arrivalTime" required style="flex-grow: 1;">
                            <button type="button" class="btn btn-secondary" id="setArrivalTimeBtn" title="í˜„ì¬ ì‹œê°ìœ¼ë¡œ ì„¤ì •">â°</button>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="departureKm">ì¶œë°œkm</label>
                        <input type="number" id="departureKm" name="departureKm" class="km-display" value="0" min="0">
                        <span class="helper-text">ìë™ ë¶ˆëŸ¬ì˜´ (í•„ìš”ì‹œ ìˆ˜ì • ê°€ëŠ¥)</span>
                    </div>
                    <div class="form-group">
                        <label for="arrivalKm">ë„ì°©km</label>
                        <input type="number" id="arrivalKm" name="arrivalKm" min="0" required>
                    </div>
                </div>
            </div>

            <div class="form-card">
                <h2 class="section-title">ğŸ“ ê¸°íƒ€ ì •ë³´</h2>
                
                <div class="form-group">
                    <label for="passengers">íƒ‘ìŠ¹ì ëª…ë‹¨ (ì„ íƒ)</label>
                    <input type="text" id="passengers" name="passengers" placeholder="ì´ë¦„ì„ ì‰¼í‘œ(,)ë‚˜ ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”">
                    <span class="helper-text">ìš´ì „ì ì œì™¸, ìŠ¹ê°ë§Œ ì…ë ¥</span>
                </div>

                <!-- ì‚¬ìš©ì ìš”ì²­: ë¹„ê³ ë€ ì¶”ê°€ -->
                <div class="form-group" style="margin-top: 20px;">
                    <label for="note">ë¹„ê³  (ì°¨ëŸ‰ ì •ë¹„ìš”ì²­ ì‚¬í•­ ë“±)</label>
                    <textarea id="note" name="note" placeholder="ì •ë¹„ ìš”ì²­ ì‚¬í•­, íŠ¹ì´ì‚¬í•­ ë“±ì„ ê¸°ë¡í•˜ì„¸ìš”."></textarea>
                </div>
                <!-- // ë¹„ê³ ë€ ì¶”ê°€ -->
            </div>
            
            <button type="submit" class="btn btn-success" id="submitBtn">ğŸ’¾ ê¸°ë¡ ì €ì¥</button>
        </form>
    </div>

    <div id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div id="loadingMessage">ì²˜ë¦¬ ì¤‘...</div>
    </div>

<script>
        // ğŸš¨ ì—¬ê¸°ì— Apps Script ì›¹ ì•± URLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzP1_Yiw0CMR53MBUaXrOd7Yhz3GaI2GgZeGA24NElbN_6OkT9j8xj8DlTohCet_351Zw/exec';

        let vehiclesKmCache = {};
        const DEBUG_MODE = false; // ë””ë²„ê¹…ì´ í•„ìš”í•˜ë©´ trueë¡œ ë³€ê²½

        document.addEventListener('DOMContentLoaded', initializeApp);

        function initializeApp() {
            setCurrentDate();
            setupEventListeners();
            debugLog('ì•± ì´ˆê¸°í™” ì™„ë£Œ');
        }
        
        async function postData(payload) {
            showLoading('ì €ì¥í•˜ëŠ” ì¤‘...');
            debugLog('POST ìš”ì²­ ì‹œì‘: ' + JSON.stringify(payload));
            
            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // CORS ë¬¸ì œ ìš°íšŒ
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                debugLog('POST ì‘ë‹µ ë°›ìŒ (no-cors ëª¨ë“œ)');
                
                // no-cors ëª¨ë“œì—ì„œëŠ” ì‘ë‹µì„ ì½ì„ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì„±ê³µìœ¼ë¡œ ê°„ì£¼
                // 'ì‘ì„±ì™„ë£Œ' ë©”ì‹œì§€ ì¶œë ¥ ìš”ì²­ ë°˜ì˜
                showSuccess('ì‘ì„±ì™„ë£Œ');
                vehiclesKmCache = {}; // ìºì‹œ ë¬´íš¨í™”
                return true;
                
            } catch (error) {
                debugLog('POST ì˜¤ë¥˜: ' + error.message);
                console.error('ë°ì´í„° ì „ì†¡ ì˜¤ë¥˜:', error);
                showWarning('ë°ì´í„° ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
                vehiclesKmCache = {};
                return false;
            } finally {
                hideLoading();
            }
        }

        function setCurrentDate() {
            const today = new Date();
            const dateString = today.toISOString().split('T')[0];
            document.getElementById('tripDate').value = dateString;
        }
        
        function getCurrentTime() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            return `${hours}:${minutes}`;
        }

        function setupEventListeners() {
            document.getElementById('vehicle').addEventListener('change', handleVehicleChange);
            document.getElementById('vehicleLogForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('arrivalKm').addEventListener('input', validateKm);
            document.getElementById('arrivalTime').addEventListener('change', validateTime);
            
            document.getElementById('setDepartureTimeBtn').addEventListener('click', () => {
                document.getElementById('departureTime').value = getCurrentTime();
            });
            
            document.getElementById('setArrivalTimeBtn').addEventListener('click', () => {
                document.getElementById('arrivalTime').value = getCurrentTime();
            });
        }

        async function handleVehicleChange() {
            const selectedVehicle = document.getElementById('vehicle').value;
            const departureKmInput = document.getElementById('departureKm');
            
            if (!selectedVehicle) {
                departureKmInput.value = 0;
                return;
            }

            // ìºì‹œ í™•ì¸
            if (vehiclesKmCache[selectedVehicle] !== undefined) {
                departureKmInput.value = vehiclesKmCache[selectedVehicle];
                debugLog('ìºì‹œì—ì„œ ì°¨ëŸ‰ ì •ë³´ ë¡œë“œ: ' + selectedVehicle);
                return;
            }

            // ë„¤íŠ¸ì›Œí¬ ìš”ì²­
            showLoading(`ì°¨ëŸ‰ ${selectedVehicle}ì˜ ìµœì¢… ì£¼í–‰ ê±°ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...`);
            debugLog('ì°¨ëŸ‰ ì •ë³´ GET ìš”ì²­: ' + selectedVehicle);
            
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getInitialData`);
                
                if (!response.ok) {
                    throw new Error('ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ' + response.status);
                }
                
                const data = await response.json();
                debugLog('GET ì‘ë‹µ: ' + JSON.stringify(data));
                
                if (data.status === 'error') {
                    throw new Error(data.message);
                }
                
                const vehiclesKmData = data.vehiclesKm || {}; 
                const lastKm = vehiclesKmData[selectedVehicle] ? vehiclesKmData[selectedVehicle].lastKm : 0;
                
                // ìºì‹œ ì—…ë°ì´íŠ¸
                for (const key in vehiclesKmData) {
                    vehiclesKmCache[key] = vehiclesKmData[key].lastKm;
                }
                
                departureKmInput.value = lastKm;
                debugLog(`ì°¨ëŸ‰ ${selectedVehicle} ì£¼í–‰ê±°ë¦¬: ${lastKm}km`);
                
                // ë“œë¡­ë‹¤ìš´ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                const select = document.getElementById('vehicle');
                Array.from(select.options).forEach(option => {
                    if (option.value === selectedVehicle) {
                        let baseText = option.textContent.split(' (í˜„ì¬')[0];
                        option.textContent = `${baseText} (í˜„ì¬: ${lastKm.toLocaleString()}km)`;
                    }
                });
                
            } catch (error) {
                debugLog('ì°¨ëŸ‰ ì •ë³´ ë¡œë“œ ì˜¤ë¥˜: ' + error.message);
                console.error('ì£¼í–‰ ê±°ë¦¬ ë¡œë“œ ì˜¤ë¥˜:', error);
                departureKmInput.value = 0;
                showError('ìµœì¢… ì£¼í–‰ ê±°ë¦¬ ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì¶œë°œ kmë¥¼ ì§ì ‘ í™•ì¸í•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”.');
            } finally {
                hideLoading();
            }
        }

        function validateKm() {
            const departureKm = parseInt(document.getElementById('departureKm').value) || 0;
            const arrivalKm = parseInt(document.getElementById('arrivalKm').value) || 0;
            if (arrivalKm < departureKm) {
                showError('ë„ì°©kmëŠ” ì¶œë°œkmë³´ë‹¤ ì‘ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return false;
            }
            return true;
        }

        function validateTime() {
            const departureTime = document.getElementById('departureTime').value;
            const arrivalTime = document.getElementById('arrivalTime').value;
            
            if (departureTime && arrivalTime && departureTime > arrivalTime) {
                showWarning('ë„ì°©ì‹œê°ì´ ì¶œë°œì‹œê°ë³´ë‹¤ ë¹ ë¦…ë‹ˆë‹¤. í™•ì¸í•´ì£¼ì„¸ìš”.');
                return false;
            }
            return true;
        }

        async function handleFormSubmit(e) {
            e.preventDefault();
            
            // ìœ íš¨ì„± ê²€ì‚¬
            if (!validateKm()) return;
            validateTime(); // ê²½ê³ ë§Œ í‘œì‹œ
            
            const vehicle = document.getElementById('vehicle').value;
            if (!vehicle) {
                showError('ì°¨ëŸ‰ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            
            const destination = data.destination.trim();
            
            let passengersInput = data.passengers || '';
            const passengers = passengersInput.split(/[\s,]+/).filter(p => p.trim() !== '');
            const passengerCount = passengers.length + 1; // ìš´ì „ì í¬í•¨
            
            const departureKm = parseInt(data.departureKm) || 0;
            const arrivalKm = parseInt(data.arrivalKm) || 0;
            
            // 'ë¹„ê³ ' í•„ë“œ ì¶”ê°€
            const note = data.note || ''; 

            const logData = {
                id: Date.now(),
                driver: data.driver,
                vehicle: data.vehicle,
                passengerCount: passengerCount, 
                passengers: passengers, 
                destination: destination,
                purpose: data.purpose,
                tripDate: data.tripDate,
                departureTime: data.departureTime,
                arrivalTime: data.arrivalTime,
                departureKm: departureKm,
                arrivalKm: arrivalKm,
                distance: arrivalKm - departureKm,
                note: note, // ë¹„ê³  ë°ì´í„° ì¶”ê°€
                recordDate: new Date().toISOString()
            };
            
            debugLog('ì œì¶œí•  ë°ì´í„°: ' + JSON.stringify(logData));
            
            const success = await postData({ action: 'addLog', data: logData });
            
            if (success === true) { 
                // ì…ë ¥ëœ ë°ì´í„° í‘œì‹œ
                displaySavedData(logData);
                
                // í¼ ì´ˆê¸°í™” ë° ë‹¤ìŒ ì…ë ¥ì„ ìœ„í•œ í•„ë“œ ì •ë¦¬
                document.getElementById('vehicleLogForm').reset();
                setCurrentDate();
                
                // í¼ ì´ˆê¸°í™” í›„ ì°¨ëŸ‰ ì„ íƒ ë° KM í•„ë“œ ì¬ì„¤ì •
                document.getElementById('vehicle').value = "";
                document.getElementById('departureKm').value = 0;
            }
        }
        
        function showAlert(id, message, duration = 3000) {
            const alert = document.getElementById(id);
            alert.textContent = message;
            alert.classList.add('show');
            setTimeout(() => alert.classList.remove('show'), duration);
        }
        
        function showSuccess(message) { 
            // ë©”ì‹œì§€ë¥¼ 'ì‘ì„±ì™„ë£Œ'ë¡œ ë³€ê²½
            debugLog('ì„±ê³µ: ' + message);
            showAlert('successAlert', message); 
        }
        
        function displaySavedData(logData) {
            const displayDiv = document.getElementById('savedDataDisplay');
            
            const passengerList = logData.passengers.length > 0 
                ? logData.passengers.join(', ') 
                : 'ì—†ìŒ';
            
            displayDiv.innerHTML = `
                <div class="saved-data">
                    <div class="saved-data-title">âœ… ${logData.note ? 'ì €ì¥ ì™„ë£Œ! (ë¹„ê³  í¬í•¨)' : 'ì €ì¥ ì™„ë£Œ!'} ì…ë ¥í•˜ì‹  ë‚´ìš©:</div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">ğŸš— ì°¨ëŸ‰</span>
                        <span class="saved-data-value">${logData.vehicle}</span>
                    </div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">ğŸ‘¤ ìš´ì „ì</span>
                        <span class="saved-data-value">${logData.driver}</span>
                    </div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">ğŸ“… ìš´í–‰ì¼ì</span>
                        <span class="saved-data-value">${logData.tripDate}</span>
                    </div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">â° ì‹œê°„</span>
                        <span class="saved-data-value">${logData.departureTime} â†’ ${logData.arrivalTime}</span>
                    </div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">ğŸ¯ í–‰ì„ ì§€</span>
                        <span class="saved-data-value">${logData.destination}</span>
                    </div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">ğŸ“ ìš´í–‰ëª©ì </span>
                        <span class="saved-data-value">${logData.purpose}</span>
                    </div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">ğŸ“ ì£¼í–‰ê±°ë¦¬</span>
                        <span class="saved-data-value">${logData.departureKm.toLocaleString()}km â†’ ${logData.arrivalKm.toLocaleString()}km (${logData.distance.toLocaleString()}km ì£¼í–‰)</span>
                    </div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">ğŸ‘¥ íƒ‘ìŠ¹ì¸ì›</span>
                        <span class="saved-data-value">${logData.passengerCount}ëª… (ìš´ì „ì + ìŠ¹ê° ${logData.passengers.length}ëª…)</span>
                    </div>
                    <div class="saved-data-item">
                        <span class="saved-data-label">ğŸ§‘â€ğŸ¤â€ğŸ§‘ íƒ‘ìŠ¹ì</span>
                        <span class="saved-data-value">${passengerList}</span>
                    </div>
                    <!-- ë¹„ê³  ë‚´ìš© í‘œì‹œ -->
                    <div class="saved-data-item" style="border-bottom: none;">
                        <span class="saved-data-label">ğŸ“¢ ë¹„ê³ </span>
                        <span class="saved-data-value">${logData.note || 'ì—†ìŒ'}</span>
                    </div>
                </div>
            `;
            
            displayDiv.style.display = 'block';
            
            // 10ì´ˆ í›„ ìë™ìœ¼ë¡œ ìˆ¨ê¹€
            setTimeout(() => {
                displayDiv.style.display = 'none';
            }, 10000);
        }
        
        function showError(message) { 
            debugLog('ì˜¤ë¥˜: ' + message);
            showAlert('errorAlert', message, 5000); 
        }
        
        function showWarning(message) { 
            debugLog('ê²½ê³ : ' + message);
            showAlert('warningAlert', message, 5000); 
        }
        
        function showLoading(message) {
            const loadingDiv = document.getElementById('loadingOverlay');
            const loadingMessage = document.getElementById('loadingMessage');
            loadingMessage.textContent = message;
            loadingDiv.style.display = 'flex';
            document.getElementById('submitBtn').disabled = true;
            debugLog('ë¡œë”© í‘œì‹œ: ' + message);
        }

        function hideLoading() {
            const loadingDiv = document.getElementById('loadingOverlay');
            loadingDiv.style.display = 'none';
            document.getElementById('submitBtn').disabled = false;
            debugLog('ë¡œë”© ìˆ¨ê¹€');
        }
        
        function debugLog(message) {
            if (DEBUG_MODE) {
                const debugInfo = document.getElementById('debugInfo');
                const timestamp = new Date().toLocaleTimeString();
                debugInfo.textContent = `[${timestamp}] ${message}\n` + debugInfo.textContent;
                debugInfo.classList.add('show');
            }
            console.log('[DEBUG] ' + message);
        }
    </script>
</body>
</html>

